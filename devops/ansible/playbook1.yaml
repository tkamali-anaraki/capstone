---

- hosts: ec2-instance

  become: true

  tasks:

    - name: install python3

      apt: name=python3 update_cache=yes state=latest



    - name: install python

      apt: name=python update_cache=yes state=latest



    - name: install java

      apt: name=openjdk-8-jre-headless update_cache=yes state=latest



    - name: install jenkins apt repository key

      apt_key: url=https://pkg.jenkins.io/debian-stable/jenkins.io.key state=present



    - name: configure the repository

      apt_repository: repo='deb https://pkg.jenkins.io/debian-stable binary/' state=present



    - name: install jenkins

      apt: name=jenkins update_cache=yes state=latest



    - name: ensure jenkins service is running

      service: name=jenkins state=started


    - name: install maven

      apt: name=maven update_cache=yes state=latest

    - name: install docker

      apt: name=docker.io update_cache=yes state=latest

- hosts: ec2-worker

  become: false

  tasks:

    - name: chnage directory

      command: 
         cmd: ~/.ssh/ssh-copy-id ubuntu@ec2-54-221-13-114.compute-1.amazonaws.com

